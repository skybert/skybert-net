#! /usr/bin/env bash

instagram_user=${1-torsteinkrause}

function get_instagam_entries() {
  local json=$(
    curl -s http://instagram.com/${instagram_user} | \
      sed \
      -e 's/[,]/,\n/g'  \
      -e 's/[{]/\n{/g' | \
      sed -n -e '/[{]"entry_data":/,/\}\;<\/script/{
s#[;]</script>##
p
    }'
  )

  # urls
  echo "$json" | sed -n 's#{"url":"\(.*_n.jpg\).*#\1#pg'

  # TODO texts
  echo "$json" | grep text
}


get_instagam_entries
